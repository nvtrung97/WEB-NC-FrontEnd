(this.webpackJsonpwebnc=this.webpackJsonpwebnc||[]).push([[0],{174:function(e,t,a){},175:function(e,t,a){(function(t){e.exports=t.config={API:"https://dev.webnc.huuhao.me/api/v1",localStorageName:"webnc_user"}}).call(this,a(54))},338:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(17),s=a.n(c),o=(a(174),a(175),a(39)),i=a(11),l=a(378),u=a(155),b=a(396),j=a(388),d=a(383),h=a(382),m=a(391),p=a(387),f=a(379),O=a(384),g=a(342),x=a(385),v=a(386),w=a(84),S=a(9),y=a.n(S),k=a(20),N=a(85),C=a(380),P=a(395),A=a(381),B=a(389),I=a(25),E=a(3);var z=function(e){var t=e.form,a=e.name,n=e.label,r=e.disabled,c=t.formState.errors,s=c[a];return Object(E.jsx)(I.a,{name:a,control:t.control,render:function(e){var t,a=e.field,o=a.onChange,i=a.onBlur,l=a.value,u=a.name;return Object(E.jsx)(B.a,{margin:"normal",variant:"outlined",fullWidth:!0,label:n,disabled:r,name:u,value:l,onChange:o,onBlur:i,error:!!s,helperText:null===(t=c[u])||void 0===t?void 0:t.message})}})},T=a(376),W=a(375),L=a(377),_=a(394),q=a(393),D=a(148),F=a.n(D),J=a(149),M=a.n(J);var V=function(e){var t,a=e.form,r=e.name,c=e.label,s=e.disabled,o=a.formState.errors,u=!!o[r],b=Object(n.useState)(!1),j=Object(i.a)(b,2),d=j[0],h=j[1],m=function(){h((function(e){return!e}))};return Object(E.jsxs)(W.a,{error:u,fullWidth:!0,margin:"normal",variant:"outlined",children:[Object(E.jsx)(_.a,{htmlFor:r,children:c}),Object(E.jsx)(I.a,{name:r,control:a.control,render:function(e){var t=e.field,a=t.onChange,n=t.onBlur,r=t.value,o=t.name;return Object(E.jsx)(q.a,{id:o,type:d?"text":"password",label:c,endAdornment:Object(E.jsx)(L.a,{position:"end",children:Object(E.jsx)(l.a,{"aria-label":"toggle password visibility",onClick:m,edge:"end",children:d?Object(E.jsx)(F.a,{}):Object(E.jsx)(M.a,{})})}),disabled:s,name:o,value:r,onChange:a,onBlur:n})}}),Object(E.jsx)(T.a,{children:null===(t=o[r])||void 0===t?void 0:t.message})]})},G=a(37),R=a(47),U=a.n(R),H=a(83),K=Object(f.a)((function(e){return{root:{position:"relative",paddingTop:e.spacing(4)},avatar:{margin:"0 auto",backgroundColor:e.palette.secondary.main},title:{textAlign:"center",margin:e.spacing(2,0,3,0)},submit:{margin:e.spacing(3,0,2,0)},progress:{position:"absolute",top:e.spacing(1),left:0,right:0}}}));var Q=function(e){var t=Object(n.useState)(""),a=Object(i.a)(t,2),r=a[0],c=a[1],s=Object(n.useState)(!1),l=Object(i.a)(s,2),u=l[0],b=l[1],j=Object(o.b)(),d=K(),m=G.a().shape({email:G.b().required("Please enter your email").email("Please enter a valid email"),password:G.b().required("Please enter your password")}),p=Object(I.e)({defaultValues:{email:"",password:""},resolver:Object(N.a)(m)}),f=function(){var t=Object(k.a)(y.a.mark((function t(a){var n,r;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(b(!0),!(n=e.onSubmit)){t.next=5;break}return t.next=5,n(a);case 5:r={login_type:"auth",email:a.email,password:a.password,token_id:""},j.signIn(r).catch((function(e){b(!1),console.log(e.response),U.a.has(e,"response")&&(e.response.data.message.includes("Password")?c("Password incorrect"):c("Email does not exist"))})).then((function(e){U.a.has(e,"status")&&201==e.status&&window.location.reload()}));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),O=p.formState.isSubmitting;return Object(E.jsxs)("div",{children:[1==u?Object(E.jsx)(H.BoxLoading,{}):"",Object(E.jsxs)("div",{className:d.root,children:[O&&Object(E.jsx)(C.a,{className:d.progress}),Object(E.jsx)(P.a,{className:d.avatar,children:Object(E.jsx)(A.a,{})}),Object(E.jsx)(g.a,{className:d.title,component:"h3",variant:"h5",children:"SIGN IN"}),Object(E.jsxs)("form",{onSubmit:p.handleSubmit(f),children:[Object(E.jsx)(z,{name:"email",label:"Email",form:p}),Object(E.jsx)(V,{name:"password",label:"Password",form:p}),Object(E.jsx)("label",{children:r}),Object(E.jsx)(h.a,{disabled:O,type:"submit",className:d.submit,variant:"contained",color:"primary",fullWidth:!0,size:"large",children:"Sign in"})]})]})]})};var X=function(e){return Object(E.jsx)("div",{children:Object(E.jsx)(Q,{})})},Y=Object(f.a)((function(e){return{root:{position:"relative",paddingTop:e.spacing(4)},avatar:{margin:"0 auto",backgroundColor:e.palette.secondary.main},title:{textAlign:"center",margin:e.spacing(2,0,3,0)},submit:{margin:e.spacing(3,0,2,0)},progress:{position:"absolute",top:e.spacing(1),left:0,right:0}}}));var Z=function(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),r=a[0],c=a[1],s=Object(n.useState)(""),l=Object(i.a)(s,2),u=l[0],b=l[1],j=Object(n.useState)(!1),d=Object(i.a)(j,2),m=d[0],p=d[1],f=Object(n.useState)(!1),O=Object(i.a)(f,2),x=O[0],v=O[1],w=Object(n.useState)(!1),S=Object(i.a)(w,2),T=S[0],W=S[1],L=Object(o.b)(),_=Y(),q=G.a().shape({email:G.b().required("Please enter your email").email("Please enter a valid email"),password:G.b().required("Please enter your password").min(6,"Please enter at least 6 characters"),full_name:G.b().required("Please enter your full name")}),D=Object(I.e)({defaultValues:{email:"",password:""},resolver:Object(N.a)(q)}),F=Object(I.e)({defaultValues:{otp:""}}),J=function(){var e=Object(k.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v(!0),c(!0),console.log(u.token_otp),L.otp(u.token_otp,t).catch((function(e){console.log(e),U.a.has(e,"response")&&e.response.data.message.includes("Wrong")&&(X("Wrong OTP"),v(!1))})).then((function(e){c(!1),U.a.has(e,"status")&&201==e.status&&X("Successful account registration")}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var t=Object(k.a)(y.a.mark((function t(a){var n;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c(!0),W(!0),a.birthday="2020-10-10",console.log(a),!(n=e.onSubmit)){t.next=8;break}return t.next=8,n(a);case 8:L.signUp(a).catch((function(e){U.a.has(e,"response")&&e.response.data.message.includes("exists")&&(X("Email exist"),W(!1))})).then((function(e){c(!1),U.a.has(e,"status")&&201==e.status&&(p(!0),console.log(e.data),b(e.data))}));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),R=Object(n.useState)(""),K=Object(i.a)(R,2),Q=K[0],X=K[1],Z=D.formState.isSubmitting;return Object(E.jsxs)("div",{className:_.root,children:[Z&&Object(E.jsx)(C.a,{className:_.progress}),Object(E.jsx)(P.a,{className:_.avatar,children:Object(E.jsx)(A.a,{})}),Object(E.jsx)(g.a,{className:_.title,component:"h3",variant:"h5",children:"Create an Account"}),1==r?Object(E.jsx)(H.BoxLoading,{}):"",Object(E.jsx)("h5",{children:Q}),m?Object(E.jsxs)("form",{onSubmit:F.handleSubmit(J),children:[Object(E.jsx)(z,{name:"otp",label:"OTP",form:F,defaultValue:""}),Object(E.jsx)(h.a,{disabled:x,type:"submit",className:_.submit,variant:"contained",color:"primary",fullWidth:!0,size:"large",children:"Submit"})]}):Object(E.jsxs)("form",{onSubmit:D.handleSubmit(M),children:[Object(E.jsx)(z,{name:"email",label:"Email",form:D}),Object(E.jsx)(V,{name:"password",label:"Password",form:D}),Object(E.jsx)(z,{name:"full_name",label:"Full Name",form:D}),Object(E.jsx)(z,{name:"address",label:"Address",form:D}),Object(E.jsx)(z,{name:"phone",label:"phone",form:D}),Object(E.jsx)(B.a,{name:"birthday",label:"Birthday",type:"date",form:D,fullWidth:!0,InputLabelProps:{shrink:!0}}),Object(E.jsx)(h.a,{disabled:T,type:"submit",className:_.submit,variant:"contained",color:"primary",fullWidth:!0,size:"large",children:"Create an account"})]})]})};var $=function(e){return Object(E.jsx)("div",{children:Object(E.jsx)(Z,{})})},ee="login",te="register";function ae(){var e=Object(o.b)(),t=e.authenticated,a=e.user;console.log("user:",a);var r=Object(n.useState)(!1),c=Object(i.a)(r,2),s=c[0],f=c[1],S=Object(n.useState)(ee),y=Object(i.a)(S,2),k=y[0],N=y[1],C=Object(n.useState)(null),P=Object(i.a)(C,2),A=P[0],B=P[1],I=function(){f(!1)},z=function(){B(null)},T=ne();return Object(E.jsxs)("div",{className:T.root,children:[Object(E.jsx)(d.a,{position:"static",children:Object(E.jsxs)(O.a,{children:[Object(E.jsx)(g.a,{variant:"h6",className:T.title,children:Object(E.jsx)(w.b,{className:T.link,to:"/",children:"HOME"})}),!t&&Object(E.jsx)(h.a,{color:"secondary",variant:"contained",onClick:function(){f(!0)},children:"Log in"}),t&&Object(E.jsx)(l.a,{color:"inherit",onClick:function(e){B(e.currentTarget)},children:Object(E.jsx)(x.a,{})})]})}),Object(E.jsxs)(u.a,{keepMounted:!0,anchorEl:A,open:Boolean(A),onClose:z,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},getContentAnchorEl:null,children:[Object(E.jsx)(b.a,{onClick:z,children:"My account"}),Object(E.jsx)(b.a,{onClick:function(){return e.signOut(),window.location.reload()},children:"Logout"})]}),Object(E.jsxs)(m.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,open:s,onClose:I,"aria-labelledby":"form-dialog-title",children:[Object(E.jsx)(l.a,{onClick:I,className:T.closeButton,children:Object(E.jsx)(v.a,{})}),Object(E.jsxs)(p.a,{children:[k===te&&Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)($,{closeDialog:I}),Object(E.jsx)(j.a,{textAlign:"center",children:Object(E.jsx)(h.a,{color:"primary",onClick:function(){return N(ee)},children:"Already have an account. Login here"})})]}),k===ee&&Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(X,{closeDialog:I}),Object(E.jsx)(j.a,{textAlign:"center",children:Object(E.jsx)(h.a,{color:"primary",onClick:function(){return N(te)},children:"Don't have an account. Register here"})})]})]})]})]})}var ne=Object(f.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},link:{color:"#fff",textDecoration:"none"},closeButton:{position:"absolute",top:e.spacing(1),right:e.spacing(1),color:e.palette.grey[500],zIndex:1}}}));var re=function(){return Object(E.jsx)(ae,{})};var ce=function(){return Object(E.jsx)(o.a,{children:Object(E.jsx)(re,{})})};s.a.render(Object(E.jsx)(r.a.StrictMode,{children:Object(E.jsx)(w.a,{children:Object(E.jsx)(ce,{})})}),document.getElementById("root"))},39:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return j}));var n=a(9),r=a.n(n),c=a(20),s=a(11),o=a(0),i=a(53),l=a(3),u=Object(o.createContext)({}),b=function(t){var a=t.children,n=Object(o.useState)(""),b=Object(s.a)(n,2),j=b[0],d=b[1];function h(){return(h=Object(c.a)(r.a.mark((function t(a){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.post("/auth/signin",a);case 2:return n=t.sent,d(n.data),i.a.defaults.headers.Authorization=n.data.accessToken,localStorage.setItem(e.config.localStorageName,JSON.stringify(n.data)),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function m(){return(m=Object(c.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.post("/auth/signup",t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return(p=Object(c.a)(r.a.mark((function e(t,a){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.a.defaults.headers.Authorization="Bearer ".concat(t),e.next=3,i.a.post("/auth/otp",a);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(o.useEffect)((function(){var t=localStorage.getItem(e.config.localStorageName);t&&(d(JSON.parse(t)),i.a.defaults.headers.Authorization=j.accessToken)}),[]),Object(l.jsx)(u.Provider,{value:{authenticated:Boolean(j),user:j,signIn:function(e){return h.apply(this,arguments)},signUp:function(e){return m.apply(this,arguments)},otp:function(e,t){return p.apply(this,arguments)},signOut:function(){d({}),localStorage.removeItem(e.config.localStorageName)}},children:a})};function j(){var e=Object(o.useContext)(u);if(!e)throw new Error("useAuth must be used within an AuthProvider.");return e}}).call(this,a(54))},53:function(e,t,a){"use strict";(function(e){var n=a(143),r=a.n(n).a.create({baseURL:e.config.API});t.a=r}).call(this,a(54))}},[[338,1,2]]]);
//# sourceMappingURL=main.3846fa2e.chunk.js.map